import { useState, useEffect } from 'react';
import { FaStar, FaRedo, FaCheckCircle, FaSquare, FaSync } from 'react-icons/fa';
import { GiPrayer } from 'react-icons/gi';
import './Athkar.css';

const ATHKAR = [
    { id: 1, arabic: 'ุณูุจูุญูุงูู ุงูููููู', translation: 'ุณุจุญุงู ุงููู - ุชูุฒูู ุงููู ุนู ูู ููุต', repeat: 33 },
    { id: 2, arabic: 'ุงููุญูููุฏู ููููููู', translation: 'ุงูุญูุฏ ููู - ุดูุฑ ุงููู ุนูู ูุนูู', repeat: 33 },
    { id: 3, arabic: 'ุงูููููู ุฃูููุจูุฑู', translation: 'ุงููู ุฃูุจุฑ - ุงููู ุฃุนุธู ูู ูู ุดูุก', repeat: 33 },
    { id: 4, arabic: 'ููุง ุฅููููู ุฅููููุง ุงูููููู ููุญูุฏููู ููุง ุดูุฑูููู ููููุ ูููู ุงูููููููู ูููููู ุงููุญูููุฏู ูููููู ุนูููู ููููู ุดูููุกู ููุฏููุฑู', translation: 'ูุง ุฅูู ุฅูุง ุงููู ูุญุฏู ูุง ุดุฑูู ููุ ุงูุฏุนุงุก ุงูุฌุงูุน', repeat: 10 },
    { id: 5, arabic: 'ุณูุจูุญูุงูู ุงูููููู ููุจูุญูููุฏููู', translation: 'ุณุจุญุงู ุงููู ูุจุญูุฏู - ุชุณุจูุญ ูุญูุฏ ููุฑูู', repeat: 100 },
    { id: 6, arabic: 'ุณูุจูุญูุงูู ุงูููููู ุงููุนูุธูููู', translation: 'ุณุจุญุงู ุงููู ุงูุนุธูู - ุฅุฌูุงู ูุชุนุธูู', repeat: 100 },
    { id: 7, arabic: 'ุฃูุณูุชูุบูููุฑู ุงูููููู', translation: 'ุฃุณุชุบูุฑ ุงููู - ุทูุจ ุงููุบูุฑุฉ', repeat: 100 },
    { id: 8, arabic: 'ุงููููููููู ุตูููู ุนูููู ููุญููููุฏู ููุนูููู ุขูู ููุญููููุฏู', translation: 'ุงูุตูุงุฉ ุนูู ุงููุจู ุตูู ุงููู ุนููู ูุณูู', repeat: 10 },
    { id: 9, arabic: 'ุญูุณูุจูููุง ุงูููููู ููููุนููู ุงููููููููู', translation: 'ุญุณุจูุง ุงููู ููุนู ุงููููู - ุงูุชููู ุนูู ุงููู', repeat: 7 },
    { id: 10, arabic: 'ููุง ุญููููู ููููุง ูููููุฉู ุฅููููุง ุจูุงูููููู', translation: 'ูุง ุญูู ููุง ููุฉ ุฅูุง ุจุงููู - ุงูุงุณุชุนุงูุฉ ุจุงููู', repeat: 10 },
    { id: 11, arabic: 'ุงููููููููู ุฃูููุชู ุงูุณููููุงูู ูููููููู ุงูุณููููุงูู ุชูุจูุงุฑูููุชู ููุง ุฐูุง ุงููุฌูููุงูู ููุงููุฅูููุฑูุงูู', translation: 'ุฏุนุงุก ุจุนุฏ ุงูุตูุงุฉ ุงููุงุฑุฏ ูู ุงูุณูุฉ', repeat: 1 },
    { id: 12, arabic: 'ุขููุฉู ุงููููุฑูุณูููู - ุงูููููู ููุง ุฅููููู ุฅููููุง ูููู ุงููุญูููู ุงูููููููููู...', translation: 'ุขูุฉ ุงููุฑุณู - ุญูุธ ูู ุงูุดูุทุงู', repeat: 1 },
    { id: 13, arabic: 'ุจูุณููู ุงูููููู ุงูููุฐูู ููุง ููุถูุฑูู ููุนู ุงุณููููู ุดูููุกู ููู ุงููุฃูุฑูุถู ููููุง ููู ุงูุณููููุงุกู', translation: 'ุฏุนุงุก ุงูุญูุธ ูุงูุญูุงูุฉ - ุซูุงุซ ูุฑุงุช ุตุจุงุญุงู ููุณุงุกู', repeat: 3 },
    { id: 14, arabic: 'ุฃูุนููุฐู ุจูููููููุงุชู ุงูููููู ุงูุชููุงูููุงุชู ูููู ุดูุฑูู ููุง ุฎููููู', translation: 'ุฏุนุงุก ุงูุงุณุชุนุงุฐุฉ ูู ุงูุดุฑ', repeat: 3 },
    { id: 15, arabic: 'ุงููููููููู ุฅููููู ุฃูุณูุฃููููู ุงููุนููููู ููุงููุนูุงููููุฉู', translation: 'ุฏุนุงุก ุงูุนุงููุฉ ูู ุงูุฏููุง ูุงูุขุฎุฑุฉ', repeat: 3 },
    { id: 16, arabic: 'ุฑูุถููุชู ุจูุงูููููู ุฑูุจููุง ููุจูุงููุฅูุณูููุงูู ุฏููููุง ููุจูููุญููููุฏู ููุจููููุง', translation: 'ุฏุนุงุก ุงูุฑุถุง ุจุงูุฅุณูุงู - ุซูุงุซ ูุฑุงุช ุตุจุงุญุงู', repeat: 3 },
    { id: 17, arabic: 'ุงููููููููู ุจููู ุฃูุตูุจูุญูููุง ููุจููู ุฃูููุณูููููุง ููุจููู ููุญูููุง ููุจููู ูููููุชู ููุฅููููููู ุงููููุดููุฑู', translation: 'ุฐูุฑ ุงูุตุจุงุญ ูุงููุณุงุก ุงูุฌุงูุน', repeat: 1 },
    { id: 18, arabic: 'ุณูุจูุญูุงูููู ููุจูุญูููุฏููู ููุง ุฅููููู ุฅููููุง ุฃูููุชู', translation: 'ุงูุชุณุจูุญ ุจุญูุฏ ุงููู ูุงูุชูุญูุฏ', repeat: 10 },
    { id: 19, arabic: 'ุงููููููููู ุงุบูููุฑู ููู ููุชูุจู ุนูููููู ุฅูููููู ุฃูููุชู ุงูุชูููููุงุจู ุงูุฑููุญูููู', translation: 'ุฏุนุงุก ุงูุชูุจุฉ ูุงูุงุณุชุบูุงุฑ', repeat: 100 },
    { id: 20, arabic: 'ููุง ุญูููู ููุง ูููููููู ุจูุฑูุญูููุชููู ุฃูุณูุชูุบููุซู', translation: 'ุงูุงุณุชุบุงุซุฉ ุจุตูุงุช ุงููู ุงูุญูุฉ', repeat: 3 },
    { id: 21, arabic: 'ููุง ุฅููููู ุฅููููุง ุงูููููู ุงูููููููู ุงููุญูููู ุงููููุจูููู', translation: 'ุฏุนุงุก ูููุฑุฃ ูุฆุฉ ูุฑุฉ ูู ุงูููู', repeat: 100 },
    { id: 22, arabic: 'ุงููููููููู ุฃูุนููููู ุนูููู ุฐูููุฑููู ููุดูููุฑููู ููุญูุณููู ุนูุจูุงุฏูุชููู', translation: 'ุฏุนุงุก ุงูุฅุนุงูุฉ ุนูู ุงูุนุจุงุฏุฉ', repeat: 3 },
    { id: 23, arabic: 'ุณูุจูุญูุงูู ุงูููููู ููุจูุญูููุฏููู ุนูุฏูุฏู ุฎููููููู ููุฑูุถูุง ููููุณููู ููุฒูููุฉู ุนูุฑูุดููู ููููุฏูุงุฏู ููููููุงุชููู', translation: 'ุชุณุจูุญ ุฌุงูุน ุนุธูู ุงููุฏุฑ', repeat: 3 },
    { id: 24, arabic: 'ุงููููููููู ุฅููููู ุฃูุนููุฐู ุจููู ูููู ุงููููููู ููุงููุญูุฒููู', translation: 'ุฏุนุงุก ุงูุงุณุชุนุงุฐุฉ ูู ุงููู ูุงูุญุฒู ูุงูุนุฌุฒ', repeat: 1 },
    { id: 25, arabic: 'ุงููููููููู ุฅููููู ุธูููููุชู ููููุณูู ุธูููููุง ููุซููุฑูุง ููููุง ููุบูููุฑู ุงูุฐูููููุจู ุฅููููุง ุฃูููุชู', translation: 'ุฏุนุงุก ุงูุงุณุชุบูุงุฑ ุงูุฌุงูุน', repeat: 1 },
    { id: 26, arabic: 'ุญูุณูุจููู ุงูููููู ููุง ุฅููููู ุฅููููุง ูููู ุนููููููู ุชููููููููุชู ูููููู ุฑูุจูู ุงููุนูุฑูุดู ุงููุนูุธูููู', translation: 'ุฏุนุงุก ุงูุชููู ุนูู ุงููู', repeat: 7 },
    { id: 27, arabic: 'ุฑูุจููููุง ุขุชูููุง ููู ุงูุฏููููููุง ุญูุณูููุฉู ููููู ุงููุขุฎูุฑูุฉู ุญูุณูููุฉู ููููููุง ุนูุฐูุงุจู ุงููููุงุฑู', translation: 'ุงูุฏุนุงุก ุงูุฌุงูุน ูุฎูุฑ ุงูุฏููุง ูุงูุขุฎุฑุฉ', repeat: 3 },
    { id: 28, arabic: 'ุงููููููููู ุฅููููู ุฃูุณูุฃููููู ุงููุฌููููุฉู ููุฃูุนููุฐู ุจููู ูููู ุงููููุงุฑู', translation: 'ุฏุนุงุก ุงูุฌูุฉ ูุงูุงุณุชุนุงุฐุฉ ูู ุงููุงุฑ', repeat: 3 },
    { id: 29, arabic: 'ุฃูุตูุจูุญูููุง ููุฃูุตูุจูุญู ุงูููููููู ููููููู ููุงููุญูููุฏู ููููููู ููุง ุฅููููู ุฅููููุง ุงูููููู ููุญูุฏููู ููุง ุดูุฑูููู ูููู', translation: 'ุฐูุฑ ุงูุตุจุงุญ - ุชูุญูุฏ ูุญูุฏ', repeat: 1 },
    { id: 30, arabic: 'ุงููููููููู ุนูุงููููู ููู ุจูุฏูููู ุงููููููููู ุนูุงููููู ููู ุณูููุนูู ุงููููููููู ุนูุงููููู ููู ุจูุตูุฑูู', translation: 'ุฏุนุงุก ุงูุนุงููุฉ ูู ุงูุฌูุงุฑุญ', repeat: 3 },
    { id: 31, arabic: 'ุฑูุจูู ุงุดูุฑูุญู ููู ุตูุฏูุฑูู ููููุณููุฑู ููู ุฃูููุฑูู', translation: 'ุฏุนุงุก ุงูุดุฑุงุญ ุงูุตุฏุฑ ูุชูุณูุฑ ุงูุฃูุฑ', repeat: 1 },
    { id: 32, arabic: 'ุงููููููููู ุฅููููู ุฃูุณูุฃููููู ุนูููููุง ููุงููุนูุง ููุฑูุฒูููุง ุทููููุจูุง ููุนูููููุง ููุชูููุจููููุง', translation: 'ุฏุนุงุก ุงูุนูู ูุงูุฑุฒู ูุงูุนูู ุงูููุจูู', repeat: 1 },
    { id: 33, arabic: 'ุณูุจูุญูุงูู ุงูููููู ููุงููุญูููุฏู ููููููู ููููุง ุฅููููู ุฅููููุง ุงูููููู ููุงูููููู ุฃูููุจูุฑู', translation: 'ุงููููุงุช ุงูุฃุฑุจุน ุงูุฃุญุจ ุฅูู ุงููู', repeat: 4 },
    { id: 34, arabic: 'ุงููููููููู ุตูููู ุนูููู ููุญููููุฏู ููุนูููู ุขูู ููุญููููุฏู ููููุง ุตููููููุชู ุนูููู ุฅูุจูุฑูุงููููู ููุนูููู ุขูู ุฅูุจูุฑูุงููููู', translation: 'ุงูุตูุงุฉ ุงูุฅุจุฑุงููููุฉ ุงููุงููุฉ', repeat: 10 },
    { id: 35, arabic: 'ููุง ุฅููููู ุฅููููุง ุฃููุชู ุณูุจูุญูุงูููู ุฅููููู ูููุชู ูููู ุงูุธููุงููููููู', translation: 'ุฏุนุงุก ูููุณ - ุฏุนุงุก ุงููุฑุจ ุงูุนุธูู', repeat: 3 },
    { id: 36, arabic: 'ุงููููููููู ุฑูุจูู ุงูุณููููุงููุงุชู ููุฑูุจูู ุงููุฃูุฑูุถู ููุฑูุจูู ุงููุนูุฑูุดู ุงููุนูุธูููู', translation: 'ุฏุนุงุก ุงูุงุณุชุนุงุฐุฉ ุจุตูุงุช ุงููู ุงูููููุฉ', repeat: 1 },
    { id: 37, arabic: 'ุงููููููููู ุงููุฏูููู ููุณูุฏููุฏูููู', translation: 'ุฏุนุงุก ุงููุฏุงูุฉ ูุงูุณุฏุงุฏ', repeat: 3 },
    { id: 38, arabic: 'ุงููููููููู ุงุฌูุนูููููู ูููู ุงูุชูููููุงุจูููู ููุงุฌูุนูููููู ูููู ุงููููุชูุทููููุฑูููู', translation: 'ุฏุนุงุก ุงูุชูุจุฉ ูุงูุทูุงุฑุฉ', repeat: 1 },
    { id: 39, arabic: 'ูููู ูููู ุงูููููู ุฃูุญูุฏู ุงูููููู ุงูุตููููุฏู ูููู ููููุฏู ูููููู ูููููุฏู ูููููู ูููููู ูููู ููููููุง ุฃูุญูุฏู', translation: 'ุณูุฑุฉ ุงูุฅุฎูุงุต - ุชุนุฏู ุซูุซ ุงููุฑุขู', repeat: 3 },
    { id: 40, arabic: 'ุฃูุนููุฐู ุจูุงูููููู ูููู ุงูุดููููุทูุงูู ุงูุฑููุฌูููู', translation: 'ุงูุงุณุชุนุงุฐุฉ ุจุงููู ูู ุงูุดูุทุงู', repeat: 3 },
    { id: 41, arabic: 'ุงููููููููู ุฃูููุชู ุฑูุจููู ููุง ุฅููููู ุฅููููุง ุฃูููุชู ุฎูููููุชูููู ููุฃูููุง ุนูุจูุฏููู', translation: 'ุณูุฏ ุงูุงุณุชุบูุงุฑ ุงููุงูู', repeat: 1 },
    { id: 42, arabic: 'ุจูุงุณููู ุงูููููู ููุงูุตููููุงุฉู ููุงูุณููููุงูู ุนูููู ุฑูุณูููู ุงูููููู', translation: 'ุฐูุฑ ุฏุฎูู ุงููุณุฌุฏ', repeat: 1 },
    { id: 43, arabic: 'ุงููููููููู ุงููุชูุญู ููู ุฃูุจูููุงุจู ุฑูุญูููุชููู', translation: 'ุฐูุฑ ุฏุฎูู ุงููุณุฌุฏ - ุทูุจ ุงูุฑุญูุฉ', repeat: 1 },
    { id: 44, arabic: 'ุงููููููููู ุฅููููู ุฃูุณูุฃููููู ูููู ููุถููููู', translation: 'ุฐูุฑ ุงูุฎุฑูุฌ ูู ุงููุณุฌุฏ', repeat: 1 },
    { id: 45, arabic: 'ุงููููููููู ุฃูุญูููููุง ุนูููู ุงููุฅูุณูููุงูู ููุชููููููููุง ุนูููู ุงููุฅููููุงูู', translation: 'ุฏุนุงุก ุงูุญูุงุฉ ุนูู ุงูุฅุณูุงู ูุงูููุช ุนูู ุงูุฅููุงู', repeat: 1 },
    { id: 46, arabic: 'ููุง ูููููููุจู ุงูููููููุจู ุซูุจููุชู ููููุจูู ุนูููู ุฏูููููู', translation: 'ุฏุนุงุก ุชุซุจูุช ุงูููุจ ุนูู ุงูุฏูู', repeat: 3 },
    { id: 47, arabic: 'ุงููููููููู ุงุบูููุฑู ููู ุฐูููุจูู ููููุณููุนู ููู ููู ุฏูุงุฑูู ููุจูุงุฑููู ููู ููู ุฑูุฒูููู', translation: 'ุฏุนุงุก ุฌุงูุน ูููุบูุฑุฉ ูุงูุฑุฒู ูุงูุชูุณุนุฉ', repeat: 1 },
    { id: 48, arabic: 'ุงููููููููู ุฃูุนูุฒูู ุงููุฅูุณูููุงูู ููุงููููุณูููููููู', translation: 'ุงูุฏุนุงุก ูุนุฒุฉ ุงูุฅุณูุงู ูุงููุณูููู', repeat: 3 },
    { id: 49, arabic: 'ุณูุจูุญูุงูู ุฑูุจูููู ุงููุนูุธูููู', translation: 'ุชุณุจูุญ ุงูุฑููุน ูู ุงูุตูุงุฉ', repeat: 3 },
    { id: 50, arabic: 'ุณูุจูุญูุงูู ุฑูุจูููู ุงููุฃูุนูููู', translation: 'ุชุณุจูุญ ุงูุณุฌูุฏ ูู ุงูุตูุงุฉ', repeat: 3 },
];

const DAILY_KEY = 'refqa_athkar_' + new Date().toDateString();

export default function Athkar() {
    const [done, setDone] = useState(() => {
        try { return new Set(JSON.parse(localStorage.getItem(DAILY_KEY) || '[]')); }
        catch { return new Set(); }
    });

    useEffect(() => {
        localStorage.setItem(DAILY_KEY, JSON.stringify([...done]));
    }, [done]);

    const toggleDone = (id) => {
        setDone(prev => {
            const next = new Set(prev);
            if (next.has(id)) next.delete(id);
            else next.add(id);
            return next;
        });
    };

    const resetAll = () => {
        if (window.confirm('ูู ุชุฑูุฏ ุฅุนุงุฏุฉ ุชุนููู ุฌููุน ุงูุฃุฐูุงุฑุ')) setDone(new Set());
    };

    const progress = Math.round((done.size / ATHKAR.length) * 100);

    return (
        <div className="page-wrapper">
            <div className="container athkar-page">
                <div className="athkar-header">
                    <h1 className="section-title"><GiPrayer style={{ fontSize: '1.5rem', verticalAlign: 'middle', marginLeft: '0.5rem' }} />ุงูุฃุฐูุงุฑ ุงูููููุฉ</h1>
                    <p className="section-subtitle">ูฅู ุฐูุฑุงู ูุฃุซูุฑุงู - ุงุถุบุท ุนูู ุงูุฐูุฑ ุนูุฏ ุฅุชูุงูู</p>
                </div>

                {/* Progress */}
                <div className="athkar-progress-wrap">
                    <div className="athkar-progress-info">
                        <div className="athkar-progress-title">
                            <FaStar style={{ color: 'var(--gold)', fontSize: '0.9rem' }} /> ุชูุฏูู ุงูููู: {done.size} / {ATHKAR.length} ุฐูุฑ
                        </div>
                        <div className="athkar-progress-track">
                            <div className="athkar-progress-fill" style={{ width: `${progress}%` }} />
                        </div>
                        <div className="athkar-progress-text">{progress}% ููุชูู{progress === 100 ? ' - ุจุงุฑู ุงููู ููู! ๐' : ''}</div>
                    </div>
                    <button className="athkar-reset-btn" onClick={resetAll}><FaSync className="reset-icon" /> ุฅุนุงุฏุฉ ุชุนููู</button>
                </div>

                <div className="athkar-grid">
                    {ATHKAR.map((z) => (
                        <div
                            key={z.id}
                            id={`athkar-${z.id}`}
                            className={`athkar-card ${done.has(z.id) ? 'done' : ''}`}
                            onClick={() => toggleDone(z.id)}
                        >
                            <div className="athkar-num">
                                {done.has(z.id) ? <FaCheckCircle style={{ color: 'var(--primary-light)' }} /> : <span className="athkar-num-text">{z.id}.</span>} ุฐูุฑ #{z.id}
                            </div>
                            <p className="athkar-arabic">{z.arabic}</p>
                            <p className="athkar-translation">{z.translation}</p>
                            <div className="athkar-counter-row">
                                <span className="athkar-repeat"><FaRedo style={{ fontSize: '0.7rem' }} /> {z.repeat} {z.repeat === 1 ? 'ูุฑุฉ' : 'ูุฑุงุช'}</span>
                                <button className="athkar-tick-btn" onClick={e => { e.stopPropagation(); toggleDone(z.id); }}>
                                    {done.has(z.id) ? <><FaCheckCircle /> ุชู</> : <><FaSquare /> ุฅุชูุงู</>}
                                </button>
                            </div>
                        </div>
                    ))}
                </div>
            </div>
        </div>
    );
}
